<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>{% block title %}Your Dashboard{% endblock %}</title>

    {# Favicons (match public_base.html) #}
    <link rel="icon" href="{{ url_for('static', filename='images/favicon_io/favicon.ico') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='images/favicon_io/apple-touch-icon.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='images/favicon_io/site.webmanifest') }}">
    <link rel="mask-icon" href="{{ url_for('static', filename='images/favicon_io/safari-pinned-tab.svg') }}" color="#3c8cff">
    <meta name="theme-color" content="#0b0f19">
    <meta name="msapplication-TileColor" content="#0b0f19">
    <meta name="msapplication-TileImage" content="{{ url_for('static', filename='images/favicon_io/android-chrome-192x192.png') }}">

    {# Shared dark shell + components (same files as admin) #}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/layouts/dashboard_shell.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/layouts/dashboard_components.css') }}">

    {# User-only compact footer styles #}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/user/user_footer.css') }}">

    {# Page / child-level styles (dashboard_content_base.css will be added by the content base) #}
    {% block extra_css %}{% endblock %}
  </head>

  <body class="dash-body">
    {# Top bar (user) #}
    <header class="dash-topbar" role="banner">
      <div class="dash-container">
        <div class="dash-topbar-left">
          <a class="dash-brand" href="{{ url_for('users_blueprint.dashboard') }}">
            <span class="dash-logo" aria-hidden="true">ğŸ‘¤</span>
            <span class="dash-brand-text">Dashboard</span>
          </a>
        </div>
        <div class="dash-topbar-right">
          <a class="dash-account" href="{{ url_for('auth_blueprint.logout') }}" title="Log out">Log out</a>
        </div>
      </div>
    </header>

    <div class="dashboard-layout">
      <!-- Side Nav (user) -->
      <aside class="dash-sidenav" role="navigation" aria-label="User sidenav">
        <h2 class="nav-title">Dashboard</h2>
        <ul class="nav-links">
          <li>
            <a href="{{ url_for('users_blueprint.dashboard') }}"
               class="{% if request.endpoint == 'users_blueprint.dashboard' %}is-active{% endif %}">
               ğŸ–¥ï¸ My Servers
            </a>
          </li>
          <li>
            <a href="{{ url_for('store_blueprint.store') }}"
               class="{% if request.endpoint == 'users_blueprint.store' %}is-active{% endif %}">
              ğŸ›’ Store
            </a>
          </li>
          <li>
            <a href="{{ url_for('vps_blueprint.orders_page', mode='all') }}"
               class="{% if request.endpoint == 'users_blueprint.order_history' %}is-active{% endif %}">
              ğŸ“¦ Purchases
            </a>
          </li>
          <li>
            <a href="{{ url_for('chat_blueprint.chat_redirect') }}"
               class="{% if request.endpoint == 'users_blueprint.chat_redirect' %}is-active{% endif %}">
              ğŸ’¬ Chat
            </a>
          </li>
          <li>
            <a href="{{ url_for('auth_blueprint.logout') }}">ğŸ”“ Log Out</a>
          </li>
        </ul>
      </aside>

      <!-- Main Content -->
      <main class="dashboard-main">
        {% block dashboard_content %}{% endblock %}
      </main>
    </div>

    {# Compact user footer (fixed) #}
    <footer class="dash-footer" role="contentinfo">
      <div class="dash-container">
        <nav class="dash-footer-links" aria-label="User quick links">
          <a href="{{ url_for('users_blueprint.dashboard') }}">Home</a>
          <a href="{{ url_for('vps_blueprint.orders_page', mode='all') }}">Orders</a>
          <a href="{{ url_for('chat_blueprint.chat_redirect') }}">Support</a>
          <a href="{{ url_for('store_blueprint.store') }}">Store</a>
          <a href="{{ url_for('users_blueprint.account_security') }}"
             class="{% if request.endpoint == 'users_blueprint.account_security' %}is-active{% endif %}">
            ğŸ” Account security
          </a>

        </nav>
        <div class="dash-footer-meta">
          <span class="text">User: {{ current_user.email }}</span>
          <span class="sep">Â·</span>
          <span class="version">v{{ app_version or "1.0.1" }}</span>
        </div>
      </div>
    </footer>

    {% block extra_js %}
    <script src="{{ url_for('static', filename='js/csrf.js') }}?v=3" defer></script>
    <script src="{{ url_for('static', filename='js/http.js') }}?v=3" defer></script>

    {% endblock %}
  </body>
</html>

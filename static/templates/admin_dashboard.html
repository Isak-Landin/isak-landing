{% extends "layouts/base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/subpages.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin_dashboard.css') }}">
{% endblock %}

{% block content %}

<!-- Header -->
{% include 'components/menu.html' %}

<div class="dashboard-layout">
  <!-- Side Nav -->
  <aside class="dashboard-sidenav">
    <h2 class="nav-title">Admin Panel</h2>
    <ul class="nav-links">
      <li><a href="{{ url_for('admin_blueprint.dashboard') }}">ğŸ‘¥ Users</a></li>
      <li><a href="{{ url_for('admin_blueprint.dashboard') }}">ğŸ–¥ï¸ VPS Instances</a></li>
      <li><a href="{{ url_for('auth_blueprint.logout') }}">ğŸ”“ Log Out</a></li>
    </ul>
  </aside>

  <!-- Main Content -->
  <main class="dashboard-main">
    <section class="radial-dark-section hero-condensed">
      <div class="container">
        <h1>Admin Overview</h1>
        <div class="user-meta">
          <span class="avatar-emoji">ğŸ›¡ï¸</span>
          <span class="email">Logged in as Admin</span>
        </div>

        <div class="hero-marker"></div>
        <p class="intro-lead">Manage users and VPS instances.</p>
      </div>
    </section>

    <div class="dashboard-summary">
      <div class="card">ğŸ‘¥ <strong>{{ users|length }}</strong> Users</div>
      <div class="card">ğŸ–¥ï¸ <strong>{{ vps_list|length }}</strong> VPSes</div>
    </div>

    <section class="split-section">
      <div class="container">
        <!-- Tab Selectors -->
        <div class="admin-tabs">
          <button class="tab-button active" id="tab-users">ğŸ‘¥ Registered Users</button>
          <button class="tab-button" id="tab-vps">ğŸ–¥ï¸ All VPS Instances</button>
        </div>

        <!-- Users Table -->
        <div class="table-container" id="users-table">
          <table>
            <thead>
              <tr>
                <th>Email</th>
                <th>VPS Count</th>
              </tr>
            </thead>
            <tbody>
              {% for user in users %}
              <tr>
                <td>{{ user.email }}</td>
                <td>{{ user.vps|length }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- VPS Table -->
        <div class="table-container hidden" id="vps-table">
          <table>
            <thead>
              <tr>
                <th>Hostname</th>
                <th>IP Address</th>
                <th>OS</th>
                <th>CPU</th>
                <th>RAM</th>
                <th>Owner</th>
              </tr>
            </thead>
            <tbody>
              {% for vps in vps_list %}
              <tr>
                <td>{{ vps.hostname }}</td>
                <td>{{ vps.ip_address }}</td>
                <td>{{ vps.os }}</td>
                <td>{{ vps.cpu_cores }} cores</td>
                <td>{{ vps.ram_mb }} MB</td>
                <td>{{ vps.user.email if vps.user else "Unknown" }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </section>

  </main>
</div>
{% endblock %}

{% extends "layouts/dashboard_base.html" %}

{% block title %}Start a Chat{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/subpages.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}

{% block dashboard_content %}
<section class="radial-dark-section hero-condensed">
  <div class="container">
    <h1>Support Chat</h1>
    <p class="intro-lead">Need help with something? Start a chat with support.</p>
    <form id="start-chat-form" action="{{ url_for('chat_blueprint.start_chat') }}" method="post">
      <button type="submit" class="button primary">Start Chat</button>
    </form>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
  document.getElementById('start-chat-form').addEventListener('submit', async function (e) {
    e.preventDefault();
    const response = await fetch(this.action, { method: 'POST' });
    const result = await response.json();
    if (result.chat_id) {
      window.location.href = `/chat/view`;
    } else {
      alert("Something went wrong starting your chat.");
    }
  });
</script>
{% endblock %}

